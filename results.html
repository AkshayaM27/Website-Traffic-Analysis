<!DOCTYPE html>
<html lang="en">
<head>
    <title>Results - Site Metrics</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        /* Navbar Styling */
        .custom-navbar {
            background-color: #534d4d;
            border: 2px solid #f8e9e9;
            border-radius: 8px;
            padding: 10px;
        }
        
        /* Graph Section */
        .graph-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
        }

        .graph-container img {
            width: 100%;
            max-width: 400px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        /* Footer */
        footer {
            background-color: #343a40;
            color: white;
            text-align: center;
            padding: 15px;
            margin-top: 30px;
        }
        /* Table container for proper spacing */
.table-container {
    width: 95%;
    margin: auto;
    overflow-x: auto;
    padding: 20px;
    background: #f9f9f9;
    border-radius: 10px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
}

/* Custom table styling */
.custom-table {
    width: 100%;
    border-collapse: collapse;
    font-family: Arial, sans-serif;
    background-color: #ffffff;
    border-radius: 8px;
    overflow: hidden;
}

/* Table headers */
.custom-table thead {
    background-color: #007bff;
    color: #ffffff;
    text-align: left;
}

.custom-table th, 
.custom-table td {
    padding: 12px;
    border-bottom: 1px solid #ddd;
}

/* Alternating row colors */
.custom-table tbody tr:nth-child(even) {
    background-color: #f2f2f2;
}

/* Hover effect */
.custom-table tbody tr:hover {
    background-color: #e0e0e0;
    transition: 0.3s ease-in-out;
}

    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <img src="{{ url_for('static', filename='images/icon.png') }}" alt="Site Metrics" width="30" height="32">
            </a>
            <a class="navbar-brand" href="{{ url_for('index') }}">Site Metrics</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link active" href="{{ url_for('index') }}">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('about') }}">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('features') }}">Features</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Graph Selection -->
        <h2 class="text-center">Graph Selection</h2>
        <form action="/results" method="post" class="text-center">
            <label>Select Graph Type:</label>
            <select name="graph_type" class="form-select d-inline-block w-auto">
                <option value="histogram">Histogram</option>
                <option value="line">Line Plot</option>
                <option value="scatter">Scatter Plot</option>
                <option value="box">Box Plot</option>
                <option value="violin">Violin Plot</option>
                
                <option value="density">Density Plot</option>
            </select>
            <button type="submit" class="btn btn-primary">Generate</button>
        </form>

        <!-- Display Graphs -->
        <h3 class="mt-4 text-center">{{ graph_type.capitalize() }} Graphs</h3>
        <div class="graph-container">
            {% for graph in graphs %}
                <img src="{{ graph }}" alt="Generated Graph">
            {% endfor %}
        </div>

        <!-- Download Buttons -->
        <div class="text-center mt-3">
            <a href="/download_graph_type_report" class="btn btn-success">Download This Graph Type (PDF)</a>
            <a href="/download_complete_report" class="btn btn-danger">Download Complete Report (PDF)</a>
        </div>
        <div class="text-center mt-4">
            <button id="analyzeButton" class="btn btn-info">Understand It Now</button>
        </div>
        <div class="table-container"><div id="analysisResults" class="mt-4"></div></div>
        
        
       <!-- Data Summary -->
<!-- Data Summary -->
<h4 class="mt-5 text-center">Dataset Summary</h4>
<div class="table-container">
    <table class="custom-table">
        {{ summary | safe }}
    </table>
</div>

    </div>

    <!-- Footer -->
    <footer>¬© 2025 Site Metrics</footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js">    </script>
        
    <script>
        document.getElementById("analyzeButton").addEventListener("click", function() {
            fetch("/analyze_data")
                .then(response => response.json())
                .then(data => {
                    let resultDiv = document.getElementById("analysisResults");
                    resultDiv.innerHTML = "<h4>üìä Clear Understanding of Your Data:</h4>";
        
                    if (data.error) {
                        resultDiv.innerHTML += `<p class="text-danger">‚ö†Ô∏è ${data.error}</p>`;
                    } else {
                        data.insights.forEach(insight => {
                            resultDiv.innerHTML += `<p>‚úîÔ∏è ${insight}</p>`;
                        });
                    }
                })
                .catch(error => {
                    console.error("Error fetching insights:", error);
                    alert("‚ö†Ô∏è Failed to load insights. Check the server.");
                });
        });
        </script>
        
            

</body>
</html>
